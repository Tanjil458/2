<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.gstatic.com https://*.firebaseapp.com https://*.googleapis.com; connect-src 'self' https://*.googleapis.com https://*.firebaseio.com https://*.cloudfunctions.net https://firestore.googleapis.com wss://*.firebaseio.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:;">
    <title>MimiPro</title>
    
    <!-- Firebase SDKs - loaded synchronously for webview compatibility -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js" onerror="console.error('Failed to load Firebase App SDK')"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js" onerror="console.error('Failed to load Firebase Auth SDK')"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js" onerror="console.error('Failed to load Firebase Firestore SDK')"></script>
    
    <!-- Global error handler for debugging -->
    <script>
      window.addEventListener('error', function(e) {
        console.error('üö® Script Error:', e.message, 'at', e.filename, 'line', e.lineno);
        console.error('Full error:', e.error);
      });
      window.addEventListener('unhandledrejection', function(e) {
        console.error('üö® Unhandled Promise Rejection:', e.reason);
      });
      console.log('‚úÖ Error handlers initialized');
    </script>
    
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/print.css" />
  </head>
  <body>
    <div class="app-shell">
      <header class="top-header">
        <div class="header-left">
          <button class="menu-btn" id="menuBtn" aria-label="Menu">‚ò∞</button>
          <div class="brand">
            <div class="brand-text">
              <h1><span class="brand-name">Mimi</span><span class="brand-pro">Pro</span></h1>
              <p>Operations</p>
            </div>
          </div>
        </div>
        <div class="header-actions">
          <span class="firebase-status" id="firebaseStatus" title="Firebase Status" style="display: none; margin-right: 8px; font-size: 10px;">
            <span class="status-dot" style="display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: #ff9800; margin-right: 4px;"></span>
          </span>
          <button class="icon-btn" id="notificationBtn" aria-label="Notifications" title="Notifications">
            <svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
          </button>
          <button class="icon-btn" id="syncBtn" aria-label="Sync" title="Sync Now">
            <svg class="header-icon" id="syncIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23 4 23 10 17 10"></polyline>
              <polyline points="1 20 1 14 7 14"></polyline>
              <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
          </button>
        </div>
      </header>

      <div class="side-nav-overlay" id="sideNavOverlay"></div>
      
      <aside class="side-nav" id="sideNav">
        <h2 class="side-title">Quick Access</h2>
        <nav class="side-links">
          <a class="side-link" href="#employee-listing"><span class="side-icon">üë•</span><span class="side-text">Employee Listing</span></a>
          <a class="side-link" href="#product-listing"><span class="side-icon">üì¶</span><span class="side-text">Product Listing</span></a>
          <a class="side-link" href="#area-listing"><span class="side-icon">üìç</span><span class="side-text">Area Listing</span></a>
          <a class="side-link" href="#customer-listing"><span class="side-icon">üßæ</span><span class="side-text">Customer Listing</span></a>
          <a class="side-link" href="#history"><span class="side-icon">üìú</span><span class="side-text">History</span></a>
          <a class="side-link" href="#settings"><span class="side-icon">‚öôÔ∏è</span><span class="side-text">Settings</span></a>
        </nav>
      </aside>

      <main class="page-content" id="pageContent">
        <section class="page" id="dashboard-page">
          <h2>Dashboard</h2>
          <p>Loading...</p>
        </section>
      </main>

      <nav class="bottom-nav" aria-label="Primary">
        <button class="nav-btn active" data-page="dashboardPage" aria-current="page">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
          <span class="nav-label">Dashboard</span>
        </button>
        <button class="nav-btn" data-page="deliveryPage">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="1" y="3" width="15" height="13"></rect>
            <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
            <circle cx="5.5" cy="18.5" r="2.5"></circle>
            <circle cx="18.5" cy="18.5" r="2.5"></circle>
          </svg>
          <span class="nav-label">Delivery</span>
        </button>
        <button class="nav-btn" data-page="creditsPage">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
            <line x1="1" y1="10" x2="23" y2="10"></line>
          </svg>
          <span class="nav-label">Credits</span>
        </button>
        <button class="nav-btn" data-page="stockPage">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
            <line x1="12" y1="22.08" x2="12" y2="12"></line>
          </svg>
          <span class="nav-label">Stock</span>
        </button>
        <button class="nav-btn" data-page="employeesPage">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
          <span class="nav-label">Employees</span>
        </button>
        <button class="nav-btn" data-page="reportsPage">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="20" x2="12" y2="10"></line>
            <line x1="18" y1="20" x2="18" y2="4"></line>
            <line x1="6" y1="20" x2="6" y2="16"></line>
          </svg>
          <span class="nav-label">Monthly</span>
        </button>
      </nav>
    </div>

    <!-- Firebase Configuration (must load before other scripts) -->
    <script src="js/firebase-config.js"></script>
    
    <!-- Utilities -->
    <script src="js/utils/helpers.js"></script>
    <script src="js/utils/date.js"></script>
    <script src="js/utils/validators.js"></script>
    
    <script src="js/app.js"></script>
    <script src="js/router.js"></script>
    <script src="js/state.js"></script>
    <script src="js/db/db.js"></script>
    <script src="js/db/sync.js"></script>
    <script src="js/modules/dashboard.js"></script>
    <script src="js/modules/delivery.js"></script>
    <script src="js/modules/stock.js"></script>
    <script src="js/modules/productListing.js"></script>
    <script src="js/modules/employees.js"></script>
    <script src="js/modules/credits.js"></script>
    <script src="js/modules/attendance.js"></script>
    <script src="js/modules/salary.js"></script>
    <script src="js/modules/advances.js"></script>
    <script src="js/modules/employeeListing.js"></script>
    <script src="js/modules/areaListing.js"></script>
    <script src="js/modules/customerListing.js"></script>
    <script src="js/modules/history.js"></script>
    <script src="js/modules/reports.js"></script>
    <script src="js/modules/settings.js"></script>
  </body>
</html>
